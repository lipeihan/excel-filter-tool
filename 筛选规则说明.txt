# 奖金筛选脚本运行规则说明

## 1. 输入文件要求
脚本会自动读取同目录下的 **`输入数据.xlsx`** 文件，该文件需包含以下 Sheet 页：
- **累计工时**：主数据源，包含工号、姓名、职位、工时等。
- **筛选条件**：用于第一轮初筛的配置表。
- **过岗数据**：用于查询员工证书信息。
- **基本数据**：用于查询入职日期、身份证等信息。
- **门店负责人**：用于查询店长与门店的对应关系。
- **门店状态表**：用于查询门店的开业/闭店时间等。

## 2. 处理流程详解
增加
时间参数配置（在筛选条件的表格中，添加一个奖金月份），如：奖金月份：2025-11，进行所有条件数据判断

### 步骤一：预筛选 (基于“筛选条件”Sheet)
脚本会先根据 `筛选条件` 页中的内容进行第一轮过滤。
- **支持跨表筛选**：您可以使用 `表名-列名` 的格式指定条件。
  - 例如：`累计工时-区域`、`基本数据-职位`。
- **逻辑**：
  - 如果筛选表中某列有值，脚本会保留符合该值的数据。
  - 如果筛选表为空，则跳过此步骤，所有人进入下一轮。


### 步骤二：奖金资格判定 (核心逻辑)
通过预筛选的人员，将根据**职位**进行不同的资格审核：

#### 1. 茶饮师 / 茶饮师（S）
- **规则**：检查是否持有有效证书。
- **条件**：必须拥有以下任一证书且状态为“有效”：
  - 【奈雪】大堂服务岗证书
  - 【奈雪】后厨岗证书
  - 【奈雪】水吧岗证书

增加：符合条件的次月参与奖金

- **结果**：有证书则**通过**，无证书则**不参与**。

#### 2. 兼职 (职位名称包含“兼职”)
- **规则**：需同时满足工时和证书的三重条件。
- **条件**：
  1. **总工时**：必须 ≥ 40小时。
  2. **证书**：必须拥有上述三个证书中的任意一个。

增加：以上条件都满足，次月参与奖金

  3. **当月考勤工时**：必须 ≥ 50小时。才可以参与当月奖金

- **结果**：三项全满足则**通过**，任一项不满足则**不参与**。

#### 3. 副经理 / 副店长
- **规则**：入职满30天的次月开始参与。（含当天）
- **条件**：
  - 计算公式：(入职日期 + 29天) 是否在奖金月份（默认为11月）之前。
  - 举例：10月1日入职，+29天是10月31日，可以在11月参与。
  - 举例：10月3日入职，+29天是11月2日，**不可以**参与11月奖金。
- **结果**：时间满足则**通过**，否则**不参与**。

#### 4. 店长 / 店长（S）
- **规则**：检查是否“带店”（即是否为当前门店的负责人）。
- **条件**：
  - 核对 `门店负责人` 表。
  - 检查该员工（工号）是否被登记为当前所在门店（门店编码）的负责人。
- **结果**：匹配成功则**通过**，否则**不参与**。

### 步骤三：结果输出
所有通过上述判定的人员，将生成到 **`筛选结果.xlsx`** 文件中。
- **字段来源**：
  - **基本信息**（工号、姓名、工时）：取自 `累计工时` 表。
  - **人事信息**（身份证、入职/离职日期）：取自 `基本数据` 表。
  - **门店信息**（开业/闭店时间、品牌）：取自 `门店状态表`。
  - **部门信息**：取自 `门店负责人` 表。
