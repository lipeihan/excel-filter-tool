# 数据筛选工具使用说明

这份说明书将指导你如何使用“数据筛选工具”来自动处理 Excel 数据。

## 1. 准备工作

在开始之前，请确保你已经准备好了以下文件，并将它们放在**同一个文件夹**中：

1.  **工具程序**：`filter_bonus_tool.exe` (如果看到的是 `filter_bonus_tool` 也可以)
2.  **输入数据**：`输入数据.xlsx` (名字必须完全一致)
3.  **输出模板**：`输出数据.xlsx` (名字必须完全一致，作为表头模板)

## 2. 如何运行

1.  找到 `filter_bonus_tool.exe` 文件。
2.  **双击**该文件。
3.  会出现一个黑色的窗口（命令行窗口），上面会显示程序的运行进度，例如：
    *   Loading data... (正在加载数据)
    *   Calculating bonus for month... (正在计算奖金月份)
    *   Successfully generated 筛选结果.xlsx (成功生成结果文件)
4.  当看到 **"Press Enter to exit..."** 的提示时，说明程序已经运行结束。
5.  此时按一下键盘上的 **回车键 (Enter)**，窗口会自动关闭。

## 3. 查看结果

程序运行完成后，文件夹中会自动生成两个新的文件：

1.  **`筛选结果.xlsx`**：符合奖金筛选条件的员工名单。
2.  **`筛选排除原因.xlsx`**：**未**符合条件的员工名单及具体原因（例如：证书过期、工时不足等）。

打开这些文件，即可查看处理结果。

## 4. 常见问题

*   **问：双击后窗口一闪而过怎么办？**
    *   答：这通常是因为输入文件缺失或名字不对。请检查文件夹里是否有名为 `输入数据.xlsx` 和 `输出数据.xlsx` 的文件。
*   **问：提示 "Error loading files" 怎么办？**
    *   答：请确保 `输入数据.xlsx` 没有被其他软件（如 Excel/WPS）打开。请先关闭所有 Excel 窗口，然后再重新运行本工具。
*   **问：生成的“筛选结果.xlsx”是空的？**
    *   答：请检查 `输入数据.xlsx` 中的“筛选条件”表是否填写正确。如果条件太严格，可能就没有符合要求的数据了。
*   **问：窗口显示 "Warning: Found duplicate..." 是什么意思？**
    *   答：这说明你的源数据表中有重复的行。程序会自动保留第一条并继续运行，但建议你检查源数据以确保准确性。
        *   `Warning: Found duplicate '工号' in '基本数据'`: 检查“基本数据”表是否有重复工号。
        *   `Warning: Found duplicate ... in '门店状态表'`: 检查“门店状态表”是否有重复门店编码。
        *   `Warning: Found duplicate ... in '门店负责人'`: 检查“门店负责人”表是否有重复部门编号。

---
**提示**：如果有任何报错信息，可以截图发给开发人员查看。
